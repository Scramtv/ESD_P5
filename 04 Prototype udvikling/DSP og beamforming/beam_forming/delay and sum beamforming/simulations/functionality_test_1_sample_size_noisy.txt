ANGLE, BEAMFORMING OUTPUT AOA, DELTA, COMPUTE TIME
-90, -76.049721, 13.950279, 0.4097
-89, 76.064121, 165.064121, 0.3937
-88, -65.220704, 22.779296, 0.3927
-87, 67.233145, 154.233145, 0.3818
-86, 79.912598, 165.912598, 0.3857
-85, -66.797536, 18.202464, 0.4054
-84, 82.627053, 166.627053, 0.4187
-83, -86.763535, 3.763535, 0.4023
-82, -75.200104, 6.799896, 0.4144
-81, -75.070501, 5.929499, 0.3896
-80, 81.262625, 161.262625, 0.3826
-79, -64.579892, 14.420108, 0.3862
-78, 76.053321, 154.053321, 0.3928
-77, -79.217784, 2.217784, 0.3911
-76, -64.403488, 11.596512, 0.3989
-75, -77.554551, 2.554551, 0.3799
-74, -69.072781, 4.927219, 0.3714
-73, 70.203204, 143.203204, 0.3853
-72, -68.208764, 3.791236, 0.4008
-71, -75.164103, 4.164103, 0.3879
-70, 69.738795, 139.738795, 0.4094
-69, -73.306466, 4.306466, 0.4002
-68, -78.562571, 10.562571, 0.3943
-67, -66.862337, 0.137663, 0.3914
-66, -68.680374, 2.680374, 0.3867
-65, -60.569411, 4.430589, 0.3861
-64, -74.670893, 10.670893, 0.3783
-63, -54.186484, 8.813516, 0.3874
-62, -60.893418, 1.106582, 0.3855
-61, -59.795396, 1.204604, 0.3957
-60, -74.202884, 14.202884, 0.3788
-59, -54.208084, 4.791916, 0.3744
-58, -68.007160, 10.007160, 0.3868
-57, -52.652853, 4.347147, 0.3869
-56, -61.383028, 5.383028, 0.3683
-55, -57.124142, 2.124142, 0.3752
-54, -53.844477, 0.155523, 0.4067
-53, -50.449609, 2.550391, 0.3731
-52, -46.964739, 5.035261, 0.3931
-51, -50.086002, 0.913998, 0.3778
-50, -48.440769, 1.559231, 0.3730
-49, -46.575932, 2.424068, 0.3899
-48, -48.843977, 0.843977, 0.3964
-47, -50.950019, 3.950019, 0.4034
-46, -43.159463, 2.840537, 0.3950
-45, -39.512590, 5.487410, 0.3891
-44, -39.966199, 4.033801, 0.3717
-43, -37.636953, 5.363047, 0.3859
-42, -42.241445, 0.241445, 0.3803
-41, -44.646293, 3.646293, 0.3774
-40, -35.581312, 4.418688, 0.3824
-39, -37.014140, 1.985860, 0.3736
-38, -38.940179, 0.940179, 0.3746
-37, -42.129843, 5.129843, 0.3757
-36, -36.146523, 0.146523, 0.3811
-35, -29.911198, 5.088802, 0.3735
-34, -34.346487, 0.346487, 0.3814
-33, -30.879618, 2.120382, 0.3830
-32, -28.957179, 3.042821, 0.3905
-31, -32.877658, 1.877658, 0.3989
-30, -28.287566, 1.712434, 0.3890
-29, -31.588832, 2.588832, 0.3733
-28, -29.165983, 1.165983, 0.3980
-27, -32.265645, 5.265645, 0.4026
-26, -28.395568, 2.395568, 0.4031
-25, -27.110342, 2.110342, 0.3848
-24, -26.174323, 2.174323, 0.3866
-23, -23.503070, 0.503070, 0.3817
-22, -25.483110, 3.483110, 0.3932
-21, -22.743455, 1.743455, 0.4010
-20, -21.130623, 1.130623, 0.3933
-19, -18.894978, 0.105022, 0.3864
-18, -18.873377, 0.873377, 0.3910
-17, -14.297686, 2.702314, 0.3759
-16, -17.472949, 1.472949, 0.4049
-15, -15.388508, 0.388508, 0.3958
-14, -13.476870, 0.523130, 0.3832
-13, -14.668493, 1.668493, 0.3905
-12, -8.605972, 3.394028, 0.4028
-11, -11.932439, 0.932439, 0.3738
-10, -4.912298, 5.087702, 0.3921
-9, -13.358067, 4.358067, 0.3974
-8, -11.853237, 3.853237, 0.3895
-7, -8.695974, 1.695974, 0.3998
-6, -6.453129, 0.453129, 0.4001
-5, -4.091482, 0.908518, 0.3726
-4, -4.307486, 0.307486, 0.4081
-3, -1.643433, 1.356567, 0.3942
-2, -0.073801, 1.926199, 0.3771
-1, -0.880218, 0.119782, 0.3877
0, -1.391428, 1.391428, 0.3818
1, 2.824256, 1.824256, 0.3956
2, 0.153003, 1.846997, 0.3800
3, 2.158243, 0.841757, 0.3797
4, 3.371467, 0.628533, 0.3797
5, 2.493050, 2.506950, 0.3937
6, 3.598272, 2.401728, 0.3903
7, 12.162843, 5.162843, 0.4006
8, 13.005260, 5.005260, 0.3848
9, 9.750795, 0.750795, 0.4013
10, 10.326807, 0.326807, 0.3945
11, 11.068421, 0.068421, 0.3759
12, 12.738855, 0.738855, 0.3856
13, 17.242545, 4.242545, 0.3932
14, 11.579632, 2.420368, 0.4005
15, 13.862077, 1.137923, 0.3957
16, 17.595352, 1.595352, 0.3904
17, 13.620872, 3.379128, 0.3823
18, 16.457729, 1.542271, 0.3937
19, 17.678154, 1.321846, 0.3743
20, 18.977780, 1.022220, 0.3951
21, 20.911018, 0.088982, 0.3789
22, 27.373147, 5.373147, 0.3906
23, 23.099862, 0.099862, 0.3954
24, 24.860297, 0.860297, 0.3870
25, 25.587512, 0.587512, 0.3800
26, 26.235525, 0.235525, 0.3798
27, 28.859977, 1.859977, 0.3844
28, 28.823976, 0.823976, 0.3803
29, 26.440729, 2.559271, 0.3829
30, 30.994820, 0.994820, 0.3766
31, 29.471989, 1.528011, 0.3829
32, 32.524850, 0.524850, 0.3896
33, 31.160423, 1.839577, 0.4045
34, 33.144063, 0.855937, 0.3936
35, 37.629753, 2.629753, 0.3921
36, 39.451389, 3.451389, 0.3875
37, 35.851317, 1.148683, 0.3782
38, 34.090882, 3.909118, 0.3901
39, 38.407368, 0.592632, 0.3896
40, 37.168943, 2.831057, 0.3861
41, 39.066181, 1.933819, 0.3879
42, 50.543211, 8.543211, 0.3831
43, 41.744635, 1.255365, 0.3685
44, 42.061441, 1.938559, 0.3866
45, 46.377928, 1.377928, 0.3812
46, 46.737935, 0.737935, 0.4043
47, 47.677554, 0.677554, 0.3828
48, 45.751515, 2.248485, 0.3823
49, 47.850357, 1.149643, 0.3790
50, 49.963599, 0.036401, 0.3755
51, 53.261265, 2.261265, 0.3920
52, 50.676414, 1.323586, 0.3652
53, 47.115942, 5.884058, 0.3792
54, 56.148523, 2.148523, 0.3944
55, 51.536831, 3.463169, 0.3796
56, 53.066861, 2.933139, 0.3783
57, 58.171763, 1.171763, 0.3787
58, 47.349947, 10.650053, 0.3746
59, 60.475810, 1.475810, 0.3780
60, 56.404128, 3.595872, 0.3833
61, 62.671853, 1.671853, 0.3804
62, 67.621952, 5.621952, 0.3786
63, 61.206624, 1.793376, 0.3999
64, 61.483830, 2.516170, 0.3815
65, 61.062621, 3.937379, 0.3797
66, 68.964779, 2.964779, 0.3760
67, 63.874277, 3.125723, 0.3678
68, 71.499230, 3.499230, 0.3832
69, 68.021560, 0.978440, 0.3946
70, 61.609832, 8.390168, 0.3722
71, 78.728175, 7.728175, 0.3777
72, 64.065081, 7.934919, 0.3895
73, 73.774475, 0.774475, 0.3696
74, 81.259025, 7.259025, 0.3864
75, 64.799496, 10.200504, 0.3818
76, -77.694954, 153.694954, 0.3841
77, 78.350167, 1.350167, 0.4287
78, 72.723254, 5.276746, 0.4116
79, 69.263585, 9.736415, 0.4270
80, -76.132523, 156.132523, 0.4478
81, 64.399888, 16.600112, 0.4848
82, -70.898018, 152.898018, 0.3954
83, 84.646693, 1.646693, 0.4266
84, 66.700334, 17.299666, 0.4329
85, 75.394508, 9.605492, 0.3741
86, -85.683514, 171.683514, 0.3951
87, 75.866117, 11.133883, 0.4104
88, 69.645193, 18.354807, 0.3929
89, -72.028441, 161.028441, 0.4485
90, 71.445229, 18.554771, 0.4147

Process finished with exit code 0

######## CODE ############

import time
import numpy as np

def beamforming_das(rx, distance, no_ele):
    theta_sweep = np.linspace(-1*np.pi/2, np.pi/2, 50000)
    results = []
    for thetas in theta_sweep:
       w = np.exp(2j * np.pi * distance * np.arange(no_ele) * np.sin(thetas))
       y = w.conj().T @ rx
       results.append(np.abs(np.sum(y)))
    return np.rad2deg(theta_sweep[np.argmax(results)])

sample_rate = 61.44e6
N = 1
t = np.arange(N)/sample_rate


### TX SIGNAL

angles = np.arange(-90, 91, 1)
print("ANGLE, BEAMFORMING OUTPUT AOA, DELTA, COMPUTE TIME")
for angle in angles:
    theta_deg = 0 # Angle of arrival
    theta_rad = np.deg2rad(angle)
    f = 2e4
    tx = np.exp(2j * np.pi * f * t)
    d = 0.5
    elements = 2
    k = np.arange(elements)

    s = np.exp(2j * np.pi * d * k * np.sin(theta_rad))
    s = s.reshape(-1,1)
    tx = tx.reshape(1,-1)

    ### RX SIGNAL
    X = s @ tx
    n = np.random.randn(elements, N) + 1j*np.random.randn(elements, N)
    X_n = X + 0.1 * n

    ### TEST CODE
    ## FUNCTIONALITY TEST
    start = time.perf_counter()
    bf_signal = beamforming_das(X_n, d, elements)
    stop = time.perf_counter()
    print(f"{angle}, {bf_signal:.6f}, {np.abs(angle-bf_signal):.6f}, {stop-start:.4f}")
