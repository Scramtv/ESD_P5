ANGLE, BEAMFORMING OUTPUT AOA, DELTA, COMPUTE TIME
-90, -90.000000, 0.000000, 10.3600
-89, -88.999075, 0.000925, 9.8944
-88, -88.000431, 0.000431, 9.3956
-87, -86.999506, 0.000494, 9.2358
-86, -86.000861, 0.000861, 9.4584
-85, -84.999937, 0.000063, 9.3164
-84, -83.999012, 0.000988, 10.0427
-83, -83.000367, 0.000367, 9.4615
-82, -81.999443, 0.000557, 9.6527
-81, -81.000798, 0.000798, 10.3389
-80, -79.999873, 0.000127, 9.4550
-79, -78.998949, 0.001051, 9.9334
-78, -78.000304, 0.000304, 9.7508
-77, -76.999379, 0.000621, 9.5859
-76, -76.000735, 0.000735, 9.5055
-75, -74.999810, 0.000190, 9.2604
-74, -73.998885, 0.001115, 9.5819
-73, -73.000241, 0.000241, 9.5490
-72, -71.999316, 0.000684, 9.4397
-71, -71.000671, 0.000671, 9.7899
-70, -69.999747, 0.000253, 9.3595
-69, -69.001102, 0.001102, 9.3809
-68, -68.000177, 0.000177, 11.2636
-67, -66.999253, 0.000747, 10.2499
-66, -66.000608, 0.000608, 9.9422
-65, -64.999683, 0.000317, 9.7060
-64, -64.001039, 0.001039, 9.4519
-63, -63.000114, 0.000114, 9.4892
-62, -61.999189, 0.000811, 9.6615
-61, -61.000545, 0.000545, 9.4943
-60, -59.999620, 0.000380, 9.7593
-59, -59.000975, 0.000975, 10.5780
-58, -58.000051, 0.000051, 9.3924
-57, -56.999126, 0.000874, 9.9072
-56, -56.000481, 0.000481, 9.5366
-55, -54.999557, 0.000443, 9.6829
-54, -54.000912, 0.000912, 10.1510
-53, -52.999987, 0.000013, 9.7535
-52, -51.999063, 0.000937, 13.5328
-51, -51.000418, 0.000418, 14.3063
-50, -49.999493, 0.000507, 14.1781
-49, -49.000849, 0.000849, 13.1247
-48, -47.999924, 0.000076, 12.9102
-47, -46.998999, 0.001001, 12.5403
-46, -46.000355, 0.000355, 12.2380
-45, -44.999430, 0.000570, 12.6526
-44, -44.000785, 0.000785, 12.2851
-43, -42.999861, 0.000139, 12.5924
-42, -41.998936, 0.001064, 12.2821
-41, -41.000291, 0.000291, 12.5867
-40, -39.999367, 0.000633, 12.5271
-39, -39.000722, 0.000722, 12.6211
-38, -37.999797, 0.000203, 12.4475
-37, -36.998873, 0.001127, 12.4879
-36, -36.000228, 0.000228, 12.6329
-35, -34.999303, 0.000697, 12.8600
-34, -34.000659, 0.000659, 12.7732
-33, -32.999734, 0.000266, 12.9498
-32, -32.001089, 0.001089, 12.4587
-31, -31.000165, 0.000165, 12.5665
-30, -29.999240, 0.000760, 12.5010
-29, -29.000595, 0.000595, 13.0866
-28, -27.999671, 0.000329, 11.2181
-27, -27.001026, 0.001026, 10.6339
-26, -26.000101, 0.000101, 9.1528
-25, -24.999177, 0.000823, 11.6871
-24, -24.000532, 0.000532, 11.6333
-23, -22.999607, 0.000393, 9.6989
-22, -22.000963, 0.000963, 9.5234
-21, -21.000038, 0.000038, 9.0673
-20, -19.999113, 0.000887, 9.6358
-19, -19.000469, 0.000469, 9.2256
-18, -17.999544, 0.000456, 9.7119
-17, -17.000899, 0.000899, 9.5634
-16, -15.999975, 0.000025, 9.1352
-15, -14.999050, 0.000950, 9.4328
-14, -14.000405, 0.000405, 9.3732
-13, -12.999481, 0.000519, 9.9006
-12, -12.000836, 0.000836, 9.4043
-11, -10.999911, 0.000089, 10.1536
-10, -9.998987, 0.001013, 9.9091
-9, -9.000342, 0.000342, 9.8738
-8, -7.999417, 0.000583, 11.6236
-7, -7.000773, 0.000773, 9.9721
-6, -5.999848, 0.000152, 9.9750
-5, -4.998923, 0.001077, 11.5559
-4, -4.000279, 0.000279, 11.5247
-3, -2.999354, 0.000646, 10.8778
-2, -2.000709, 0.000709, 10.1702
-1, -0.999785, 0.000215, 9.9666
0, 0.001140, 0.001140, 11.4174
1, 0.999785, 0.000215, 11.1056
2, 2.000709, 0.000709, 9.5484
3, 2.999354, 0.000646, 9.4146
4, 4.000279, 0.000279, 9.7666
5, 4.998923, 0.001077, 9.2945
6, 5.999848, 0.000152, 9.3032
7, 7.000773, 0.000773, 9.9948
8, 7.999417, 0.000583, 12.0547
9, 9.000342, 0.000342, 11.4324
10, 9.998987, 0.001013, 9.2321
11, 10.999911, 0.000089, 9.2547
12, 12.000836, 0.000836, 10.3308
13, 12.999481, 0.000519, 9.5354
14, 14.000405, 0.000405, 9.3227
15, 14.999050, 0.000950, 10.3283
16, 15.999975, 0.000025, 9.3212
17, 17.000899, 0.000899, 9.5441
18, 17.999544, 0.000456, 10.8446
19, 19.000469, 0.000469, 9.8103
20, 19.999113, 0.000887, 9.5638
21, 21.000038, 0.000038, 10.6497
22, 22.000963, 0.000963, 9.2790
23, 22.999607, 0.000393, 9.8515
24, 24.000532, 0.000532, 11.5308
25, 24.999177, 0.000823, 9.6366
26, 26.000101, 0.000101, 9.3717
27, 27.001026, 0.001026, 9.5379
28, 27.999671, 0.000329, 9.3760
29, 29.000595, 0.000595, 10.0752
30, 29.999240, 0.000760, 11.0836
31, 31.000165, 0.000165, 9.4595
32, 32.001089, 0.001089, 9.4691
33, 32.999734, 0.000266, 9.1606
34, 34.000659, 0.000659, 9.7923
35, 34.999303, 0.000697, 9.3738
36, 36.000228, 0.000228, 9.1793
37, 36.998873, 0.001127, 9.6662
38, 37.999797, 0.000203, 9.9686
39, 39.000722, 0.000722, 10.1656
40, 39.999367, 0.000633, 10.3284
41, 41.000291, 0.000291, 9.3934
42, 41.998936, 0.001064, 9.0294
43, 42.999861, 0.000139, 9.2211
44, 44.000785, 0.000785, 10.3692
45, 44.999430, 0.000570, 10.2140
46, 46.000355, 0.000355, 9.8581
47, 46.998999, 0.001001, 9.9599
48, 47.999924, 0.000076, 9.3839
49, 49.000849, 0.000849, 14.3153
50, 49.999493, 0.000507, 13.2426
51, 51.000418, 0.000418, 12.7686
52, 51.999063, 0.000937, 12.5271
53, 52.999987, 0.000013, 12.3563
54, 54.000912, 0.000912, 12.4440
55, 54.999557, 0.000443, 12.3834
56, 56.000481, 0.000481, 12.4417
57, 56.999126, 0.000874, 12.4065
58, 58.000051, 0.000051, 12.7469
59, 59.000975, 0.000975, 12.6600
60, 59.999620, 0.000380, 12.5438
61, 61.000545, 0.000545, 12.2392
62, 61.999189, 0.000811, 12.4704
63, 63.000114, 0.000114, 12.6516
64, 64.001039, 0.001039, 12.5390
65, 64.999683, 0.000317, 12.2695
66, 66.000608, 0.000608, 12.2199
67, 66.999253, 0.000747, 12.0901
68, 68.000177, 0.000177, 12.7260
69, 69.001102, 0.001102, 12.2168
70, 69.999747, 0.000253, 12.4750
71, 71.000671, 0.000671, 12.6027
72, 71.999316, 0.000684, 12.4492
73, 73.000241, 0.000241, 12.6245
74, 73.998885, 0.001115, 12.1809
75, 74.999810, 0.000190, 12.1847
76, 76.000735, 0.000735, 12.3239
77, 76.999379, 0.000621, 12.4403
78, 78.000304, 0.000304, 12.0288
79, 78.998949, 0.001051, 12.1424
80, 79.999873, 0.000127, 12.2853
81, 81.000798, 0.000798, 12.2124
82, 81.999443, 0.000557, 12.2337
83, 83.000367, 0.000367, 12.3189
84, 83.999012, 0.000988, 12.3490
85, 84.999937, 0.000063, 11.9090
86, 86.000861, 0.000861, 12.0998
87, 86.999506, 0.000494, 12.3374
88, 88.000431, 0.000431, 11.9866
89, 88.999075, 0.000925, 12.0922
90, 89.990880, 0.009120, 12.0789

Process finished with exit code 0

####### CODE #######

import time
import numpy as np

def beamforming_das(rx, distance, no_ele):
    theta_sweep = np.linspace(-1*np.pi/2, np.pi/2, 78948)
    results = []
    for thetas in theta_sweep:
       w = np.exp(2j * np.pi * distance * np.arange(no_ele) * np.sin(thetas))
       y = w.conj().T @ rx
       results.append(np.abs(np.sum(y)))
    return np.rad2deg(theta_sweep[np.argmax(results)])

sample_rate = 61.44e6
N = 10000
t = np.arange(N)/sample_rate


### TX SIGNAL

angles = np.arange(-90, 91, 1)
print("ANGLE, BEAMFORMING OUTPUT AOA, DELTA, COMPUTE TIME")
for angle in angles:
    theta_deg = 0 # Angle of arrival
    theta_rad = np.deg2rad(angle)
    f = 2e4
    tx = np.exp(2j * np.pi * f * t)
    d = 0.5
    elements = 2
    k = np.arange(elements)

    s = np.exp(2j * np.pi * d * k * np.sin(theta_rad))
    s = s.reshape(-1,1)
    tx = tx.reshape(1,-1)

    ### RX SIGNAL
    X = s @ tx
    n = np.random.randn(elements, N) + 1j*np.random.randn(elements, N)
    X_n = X + 0.0 * n

    ### TEST CODE
    ## FUNCTIONALITY TEST
    start = time.perf_counter()
    bf_signal = beamforming_das(X_n, d, elements)
    stop = time.perf_counter()
    print(f"{angle}, {bf_signal:.6f}, {np.abs(angle-bf_signal):.6f}, {stop-start:.4f}")