ANGLE, BEAMFORMING OUTPUT AOA, DELTA, COMPUTE TIME
-90, -90.000000, 0.000000, 0.2303
-89, -88.918919, 0.081081, 0.2472
-88, -88.018018, 0.018018, 0.2258
-87, -86.936937, 0.063063, 0.2646
-86, -86.036036, 0.036036, 0.2459
-85, -84.954955, 0.045045, 0.2738
-84, -84.054054, 0.054054, 0.2659
-83, -82.972973, 0.027027, 0.2879
-82, -82.072072, 0.072072, 0.2843
-81, -80.990991, 0.009009, 0.2620
-80, -80.090090, 0.090090, 0.2670
-79, -79.009009, 0.009009, 0.2617
-78, -77.927928, 0.072072, 0.2628
-77, -77.027027, 0.027027, 0.2696
-76, -75.945946, 0.054054, 0.2660
-75, -75.045045, 0.045045, 0.2597
-74, -73.963964, 0.036036, 0.2105
-73, -73.063063, 0.063063, 0.2552
-72, -71.981982, 0.018018, 0.2523
-71, -71.081081, 0.081081, 0.2393
-70, -70.000000, 0.000000, 0.2625
-69, -68.918919, 0.081081, 0.2475
-68, -68.018018, 0.018018, 0.2536
-67, -66.936937, 0.063063, 0.2551
-66, -66.036036, 0.036036, 0.2560
-65, -64.954955, 0.045045, 0.2601
-64, -64.054054, 0.054054, 0.2301
-63, -62.972973, 0.027027, 0.2104
-62, -62.072072, 0.072072, 0.2431
-61, -60.990991, 0.009009, 0.2477
-60, -60.090090, 0.090090, 0.2353
-59, -59.009009, 0.009009, 0.2271
-58, -57.927928, 0.072072, 0.2609
-57, -57.027027, 0.027027, 0.2208
-56, -55.945946, 0.054054, 0.2740
-55, -55.045045, 0.045045, 0.2703
-54, -53.963964, 0.036036, 0.2569
-53, -53.063063, 0.063063, 0.2616
-52, -51.981982, 0.018018, 0.2655
-51, -51.081081, 0.081081, 0.2656
-50, -50.000000, 0.000000, 0.2684
-49, -48.918919, 0.081081, 0.2643
-48, -48.018018, 0.018018, 0.2601
-47, -46.936937, 0.063063, 0.2583
-46, -46.036036, 0.036036, 0.2600
-45, -44.954955, 0.045045, 0.2706
-44, -44.054054, 0.054054, 0.2567
-43, -42.972973, 0.027027, 0.2636
-42, -42.072072, 0.072072, 0.2531
-41, -40.990991, 0.009009, 0.2545
-40, -40.090090, 0.090090, 0.2493
-39, -39.009009, 0.009009, 0.2599
-38, -37.927928, 0.072072, 0.2581
-37, -37.027027, 0.027027, 0.2479
-36, -35.945946, 0.054054, 0.2655
-35, -35.045045, 0.045045, 0.2609
-34, -33.963964, 0.036036, 0.2660
-33, -33.063063, 0.063063, 0.2647
-32, -31.981982, 0.018018, 0.2288
-31, -31.081081, 0.081081, 0.2222
-30, -30.000000, 0.000000, 0.2327
-29, -28.918919, 0.081081, 0.2578
-28, -28.018018, 0.018018, 0.2613
-27, -26.936937, 0.063063, 0.2622
-26, -26.036036, 0.036036, 0.2614
-25, -24.954955, 0.045045, 0.2670
-24, -24.054054, 0.054054, 0.2629
-23, -22.972973, 0.027027, 0.2656
-22, -22.072072, 0.072072, 0.2470
-21, -20.990991, 0.009009, 0.2597
-20, -20.090090, 0.090090, 0.2641
-19, -19.009009, 0.009009, 0.2617
-18, -17.927928, 0.072072, 0.2624
-17, -17.027027, 0.027027, 0.2687
-16, -15.945946, 0.054054, 0.2629
-15, -15.045045, 0.045045, 0.2680
-14, -13.963964, 0.036036, 0.2633
-13, -13.063063, 0.063063, 0.2649
-12, -11.981982, 0.018018, 0.2608
-11, -11.081081, 0.081081, 0.2640
-10, -10.000000, 0.000000, 0.2694
-9, -8.918919, 0.081081, 0.2641
-8, -8.018018, 0.018018, 0.2603
-7, -6.936937, 0.063063, 0.2512
-6, -6.036036, 0.036036, 0.2479
-5, -4.954955, 0.045045, 0.2554
-4, -4.054054, 0.054054, 0.2495
-3, -2.972973, 0.027027, 0.2474
-2, -2.072072, 0.072072, 0.2517
-1, -0.990991, 0.009009, 0.2598
0, 0.090090, 0.090090, 0.2627
1, 0.990991, 0.009009, 0.2696
2, 2.072072, 0.072072, 0.2660
3, 2.972973, 0.027027, 0.2611
4, 4.054054, 0.054054, 0.2652
5, 4.954955, 0.045045, 0.2682
6, 6.036036, 0.036036, 0.2586
7, 6.936937, 0.063063, 0.2618
8, 8.018018, 0.018018, 0.2678
9, 8.918919, 0.081081, 0.2224
10, 10.000000, 0.000000, 0.2640
11, 11.081081, 0.081081, 0.2651
12, 11.981982, 0.018018, 0.2635
13, 13.063063, 0.063063, 0.2604
14, 13.963964, 0.036036, 0.2637
15, 15.045045, 0.045045, 0.2608
16, 15.945946, 0.054054, 0.2677
17, 17.027027, 0.027027, 0.2646
18, 17.927928, 0.072072, 0.2653
19, 19.009009, 0.009009, 0.2623
20, 20.090090, 0.090090, 0.2613
21, 20.990991, 0.009009, 0.2719
22, 22.072072, 0.072072, 0.2633
23, 22.972973, 0.027027, 0.2633
24, 24.054054, 0.054054, 0.2600
25, 24.954955, 0.045045, 0.2635
26, 26.036036, 0.036036, 0.2635
27, 26.936937, 0.063063, 0.2687
28, 28.018018, 0.018018, 0.2608
29, 28.918919, 0.081081, 0.2612
30, 30.000000, 0.000000, 0.2637
31, 31.081081, 0.081081, 0.2622
32, 31.981982, 0.018018, 0.2619
33, 33.063063, 0.063063, 0.2566
34, 33.963964, 0.036036, 0.2638
35, 35.045045, 0.045045, 0.2633
36, 35.945946, 0.054054, 0.2913
37, 37.027027, 0.027027, 0.2435
38, 37.927928, 0.072072, 0.2119
39, 39.009009, 0.009009, 0.1998
40, 40.090090, 0.090090, 0.2813
41, 40.990991, 0.009009, 0.2592
42, 42.072072, 0.072072, 0.2519
43, 42.972973, 0.027027, 0.2597
44, 44.054054, 0.054054, 0.2368
45, 44.954955, 0.045045, 0.2826
46, 46.036036, 0.036036, 0.2529
47, 46.936937, 0.063063, 0.2588
48, 48.018018, 0.018018, 0.2017
49, 48.918919, 0.081081, 0.2573
50, 50.000000, 0.000000, 0.2589
51, 51.081081, 0.081081, 0.2602
52, 51.981982, 0.018018, 0.2648
53, 53.063063, 0.063063, 0.2662
54, 53.963964, 0.036036, 0.2588
55, 55.045045, 0.045045, 0.2579
56, 55.945946, 0.054054, 0.2333
57, 57.027027, 0.027027, 0.2701
58, 57.927928, 0.072072, 0.2864
59, 59.009009, 0.009009, 0.2093
60, 60.090090, 0.090090, 0.2435
61, 60.990991, 0.009009, 0.2255
62, 62.072072, 0.072072, 0.2061
63, 62.972973, 0.027027, 0.2124
64, 64.054054, 0.054054, 0.2146
65, 64.954955, 0.045045, 0.2473
66, 66.036036, 0.036036, 0.2243
67, 66.936937, 0.063063, 0.1942
68, 68.018018, 0.018018, 0.3047
69, 68.918919, 0.081081, 0.2440
70, 70.000000, 0.000000, 0.2484
71, 71.081081, 0.081081, 0.2439
72, 71.981982, 0.018018, 0.2031
73, 73.063063, 0.063063, 0.2583
74, 73.963964, 0.036036, 0.2674
75, 75.045045, 0.045045, 0.2755
76, 75.945946, 0.054054, 0.2692
77, 77.027027, 0.027027, 0.2589
78, 77.927928, 0.072072, 0.2574
79, 79.009009, 0.009009, 0.2095
80, 80.090090, 0.090090, 0.2429
81, 80.990991, 0.009009, 0.2636
82, 82.072072, 0.072072, 0.2012
83, 82.972973, 0.027027, 0.2422
84, 84.054054, 0.054054, 0.2895
85, 84.954955, 0.045045, 0.2389
86, 86.036036, 0.036036, 0.2009
87, 86.936937, 0.063063, 0.2766
88, 88.018018, 0.018018, 0.2620
89, 88.918919, 0.081081, 0.2036
90, -90.000000, 180.000000, 0.2424

Process finished with exit code 0

####### CODE #######

import time
import numpy as np

def beamforming_das(rx, distance, no_ele):
    theta_sweep = np.linspace(-1*np.pi/2, np.pi/2, 1000)
    results = []
    for thetas in theta_sweep:
       w = np.exp(2j * np.pi * distance * np.arange(no_ele) * np.sin(thetas))
       y = w.conj().T @ rx
       results.append(np.abs(np.sum(y)))
    return np.rad2deg(theta_sweep[np.argmax(results)])

sample_rate = 61.44e6
N = 10000
t = np.arange(N)/sample_rate


### TX SIGNAL

angles = np.arange(-90, 91, 1)
print("ANGLE, BEAMFORMING OUTPUT AOA, DELTA, COMPUTE TIME")
for angle in angles:
    theta_deg = 0 # Angle of arrival
    theta_rad = np.deg2rad(angle)
    f = 2e4
    tx = np.exp(2j * np.pi * f * t)
    d = 0.5
    elements = 2
    k = np.arange(elements)

    s = np.exp(2j * np.pi * d * k * np.sin(theta_rad))
    s = s.reshape(-1,1)
    tx = tx.reshape(1,-1)

    ### RX SIGNAL
    X = s @ tx
    n = np.random.randn(elements, N) + 1j*np.random.randn(elements, N)
    X_n = X + 0.0 * n

    ### TEST CODE
    ## FUNCTIONALITY TEST
    start = time.perf_counter()
    bf_signal = beamforming_das(X_n, d, elements)
    stop = time.perf_counter()
    print(f"{angle}, {bf_signal:.6f}, {np.abs(angle-bf_signal):.6f}, {stop-start:.4f}")
