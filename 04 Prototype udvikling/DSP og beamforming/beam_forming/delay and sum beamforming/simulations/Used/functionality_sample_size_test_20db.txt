---20 dB SNR Sample Size Test Start---
SAMPLE SIZE, AOA
1
4.853003, 2.983394, 3.886278, 5.728527, 0.530102, 0.448022, 0.297541, 3.610397, -2.370071, -1.633628, 0.197221, 3.685637, -0.322622, -2.600352, -6.200489, -5.128884, -3.339076, 0.147061, -1.852509, -0.153901, 2.267471, 6.893612, -6.401130, 2.885353, 1.113785, -4.716202, 5.762727, -4.896323, -4.894043, 4.226000, -3.480436, 
2
-3.947838, -2.835193, 1.761308, 0.245101, 5.140284, -2.924114, 2.449871, 1.980189, -0.137941, 2.805553, -2.153470, 2.094190, -2.577552, 4.472241, -1.068185, -1.116065, 0.242821, 3.286635, -1.118345, 0.270181, 0.833344, -0.023940, 0.511862, -1.597147, -2.509152, 3.256995, -1.695188, 5.153964, 4.054999, -1.405627, 4.508721, 
3
0.705663, 3.366436, 1.779548, 1.752188, -0.653223, 0.443462, -3.220515, -0.787744, 3.414316, 1.236906, 5.393365, 0.409262, 5.603126, 2.205910, -1.088705, -2.552472, 0.742143, 0.824224, -0.055860, -0.753544, 2.023509, -0.685143, 3.849798, 0.121981, -0.682863, 0.505022, -1.831989, 0.769504, -0.589383, 3.243315, 1.428427, 
4
-3.469036, -0.085500, -0.616743, 2.721193, -2.169430, -0.343142, -0.448022, -0.892624, 2.388311, 0.548343, 1.572067, 1.973349, 1.268826, -1.531027, 0.748983, 3.441676, 2.892193, 2.721193, -2.472672, 0.427502, -0.527822, -1.756748, 0.505022, 2.876233, -1.499107, 2.739433, 0.885784, -1.006625, -1.483147, 1.569787, 2.230990, 
5
-0.106020, 0.375062, 0.215461, -1.749908, -0.475382, -0.023940, -1.540147, 1.884429, 1.031705, -0.990665, -0.288421, 1.793228, 0.571143, -0.571143, 2.762233, 0.391022, 1.209546, 1.521907, 1.788668, -0.242821, 1.549267, -1.396507, 1.829709, 2.203630, -0.493622, -1.665548, -0.922264, 0.053580, -0.575703, -0.701103, -4.314920, 
6
0.450302, 2.762233, 0.039900, -1.977909, -1.542427, 1.870749, -1.002065, -2.807833, -0.049020, -1.779548, 0.628143, 1.774988, 0.149341, 2.007549, 0.967865, 3.355036, -0.938224, -0.837904, -1.220946, -1.592587, 2.205910, -0.135661, -1.214106, 1.663268, 0.653223, 1.246026, 0.493622, -1.916349, 1.136585, -0.064980, 0.080940, 
7
0.379622, -0.014820, 0.753544, 1.428427, 0.042180, -1.029425, 3.268395, -0.949624, -1.357746, 0.482222, -1.895829, -1.822869, -0.908584, -1.426147, 0.696543, -2.376911, -0.730743, -1.606267, -0.080940, -0.634983, -0.851584, 0.730743, -0.115141, -0.621303, 0.587103, 0.005700, -0.929104, 1.569787, -1.024865, -0.379622, 2.123830, 
8
-1.649588, -0.543783, 0.479942, 1.987029, 1.966509, -0.479942, -0.427502, -1.622228, -2.702953, -0.787744, 2.228710, -1.660988, -0.660063, 0.548343, -1.923189, 1.184466, -0.970145, -0.502742, 0.005700, -1.480867, 1.483147, -0.805984, -2.429351, -1.220946, -1.448947, -1.138865, 1.667828, -0.438902, -1.779548, 1.503667, 4.962443, 
9
-0.384182, -0.536943, 2.192230, 2.712073, -0.206341, -0.573423, 0.288421, 0.874384, -0.206341, 1.615388, 0.484502, -0.156181, -0.603063, -0.163021, -0.197221, -0.593943, 1.006625, -0.842464, 1.287066, -1.122905, 0.566583, 1.277946, 0.728463, -1.658708, 0.623583, -2.192230, 1.193586, 0.979265, 1.152545, 0.368222, -3.304875, 
10
1.184466, 1.934589, -0.803704, -1.040825, 0.564303, 1.417027, -1.553827, -0.224581, -0.238261, 0.876664, -2.479512, -1.252866, 1.330386, -0.764944, 0.566583, 0.288421, 0.231421, 0.655503, -1.075025, 0.283861, -1.204986, 0.427502, 2.438471, 0.151621, -0.730743, 1.150265, -0.728463, -2.618592, -0.883504, -1.056785, 2.306231, 
20
-0.370502, -1.086425, 1.052225, 0.019380, -0.420662, 0.641823, 0.728463, -0.438902, -0.710223, -0.375062, -0.929104, 0.835624, -0.181261, 0.568863, -0.391022, -0.459422, -0.106020, 1.154825, -0.064980, -0.733023, 0.922264, -1.271106, 0.500462, 0.386462, -1.122905, 1.070465, 1.786388, -0.131101, -1.565227, -0.550623, -0.495902, 
30
-0.224581, 0.646383, -0.862984, 0.126541, 0.701103, -1.517347, -0.739863, 0.525542, -0.988385, 0.685143, -0.491342, 0.299821, 0.370502, -0.801424, -1.289346, 0.443462, 0.582543, -0.334022, 0.375062, 0.498182, 0.835624, -1.154825, 1.346346, -0.178981, -0.365942, -0.450302, -0.010260, -0.840184, 0.539223, 1.061345, -1.161665, 
40
-0.099180, 0.188101, -0.707943, 0.085500, 0.566583, 0.377342, -0.258781, -0.308941, -0.404702, -0.783184, 0.441182, -0.420662, 0.087780, 0.206341, 0.411542, 0.500462, 0.541503, -0.393302, 0.780904, -0.235981, -0.160741, -0.621303, 0.137941, -0.721623, -0.299821, -0.039900, -0.705663, -0.042180, -0.007980, 0.904024, 0.345422, 
50
0.192661, 1.241466, -0.714783, -1.895829, 0.163021, 0.119701, 0.584823, -0.046740, 0.375062, -0.698823, -0.491342, 0.520982, -0.176701, -1.095545, 0.790024, -0.283861, -0.067260, 0.147061, -0.432062, -0.318061, 0.764944, 1.104665, -0.735303, 0.311221, -0.340862, -0.021660, -0.210901, -0.580263, -0.746703, -0.121981, -0.345422, 
60
-0.208621, -0.099180, -0.758104, -0.427502, 0.144781, 0.135661, -0.058140, 0.265621, 0.069540, -0.422942, 0.242821, 0.769504, 0.142501, -0.639543, 0.404702, 0.261061, -0.071820, 0.612183, -0.347702, -0.409262, -0.347702, -0.110581, 0.274741, -0.256501, -0.064980, 0.185821, -0.413822, -0.069540, -0.215461, 0.235981, -0.001140, 
70
0.194941, -0.176701, 0.071820, 0.422942, 0.628143, 0.003420, -0.087780, 0.318061, -0.208621, -0.290701, -0.007980, -0.028500, -0.085500, 0.445742, 0.135661, 0.354542, -0.233701, 0.194941, 0.188101, 0.502742, 0.596223, -0.140221, 0.970145, -0.646383, 0.226861, -0.270181, 0.281581, -0.067260, 0.582543, -0.078660, 0.292981, 
80
0.354542, 0.261061, -0.397862, 0.543783, 0.500462, -0.523262, -0.413822, -0.609903, -0.368222, 0.074100, -0.413822, 0.229141, -0.007980, -0.286141, -0.270181, -0.046740, 0.261061, -0.233701, -0.090060, 0.108301, -0.826504, 0.167581, -0.482222, -0.283861, -0.605343, -0.270181, 0.062700, -1.259706, 0.101460, -0.055860, -0.174421, 
90
0.591663, 0.308941, 0.302101, 0.935944, -0.395582, 0.336302, -0.404702, 0.295261, -0.279301, 0.067260, -0.096900, 0.393302, 0.215461, 0.235981, -0.076380, -0.007980, -0.571143, 0.327182, 0.411542, 0.347702, -0.655503, 0.577983, 0.603063, 0.121981, -0.568863, -0.302101, -0.461702, 0.080940, -0.391022, -0.158461, -0.151621, 
100
0.060420, -0.336302, -0.550623, -0.571143, -0.664623, -0.796864, -0.135661, 0.343142, -0.183541, -0.080940, 0.603063, -0.687423, -0.484502, -0.286141, 0.411542, 0.010260, -0.149341, -0.169861, 0.010260, 0.042180, -0.349982, -0.062700, -0.352262, -0.238261, 0.628143, 0.267901, 0.087780, -0.023940, 0.288421, -0.213181, -0.222301, 
200
-0.090060, -0.473102, 0.169861, 0.313501, 0.386462, 0.007980, -0.375062, -0.060420, 0.121981, 0.454862, -0.386462, -0.327182, 0.534662, -0.172141, 0.208621, -0.197221, 0.311221, -0.074100, -0.039900, -0.340862, -0.256501, -0.142501, 0.049020, -0.094620, -0.144781, 0.028500, -0.258781, 0.199501, -0.064980, -0.080940, -0.197221, 
300
-0.224581, 0.270181, -0.564303, 0.422942, 0.053580, -0.117421, -0.092340, -0.026220, -0.213181, 0.121981, 0.076380, -0.192661, -0.071820, 0.051300, -0.023940, 0.169861, -0.126541, 0.210901, -0.258781, 0.525542, -0.142501, 0.568863, -0.279301, 0.144781, 0.142501, -0.473102, -0.117421, -0.115141, 0.240541, -0.224581, -0.053580, 
400
0.220021, 0.026220, 0.035340, 0.112861, 0.174421, -0.026220, -0.190381, -0.352262, -0.388742, -0.229141, 0.001140, -0.172141, 0.033060, -0.204061, 0.133381, 0.149341, -0.039900, 0.279301, 0.019380, 0.106020, 0.197221, 0.167581, -0.158461, -0.014820, 0.224581, -0.340862, -0.263341, -0.014820, 0.279301, -0.208621, -0.026220, 
500
0.106020, 0.206341, 0.220021, -0.067260, -0.003420, 0.190381, 0.039900, -0.313501, 0.069540, 0.158461, 0.229141, 0.062700, 0.001140, 0.235981, 0.194941, 0.035340, 0.144781, 0.023940, -0.163021, -0.137941, 0.012540, 0.069540, 0.245101, -0.277021, -0.010260, -0.160741, 0.106020, -0.176701, 0.258781, 0.256501, 0.028500, 
600
0.076380, -0.053580, -0.023940, -0.019380, -0.080940, -0.270181, -0.021660, -0.454862, -0.117421, -0.080940, -0.194941, -0.160741, 0.028500, 0.190381, -0.053580, 0.037620, -0.064980, -0.112861, -0.003420, -0.115141, 0.320341, -0.117421, 0.167581, 0.021660, -0.140221, 0.090060, 0.078660, 0.067260, -0.194941, -0.204061, 0.042180, 
700
0.014820, 0.010260, 0.151621, -0.242821, -0.167581, -0.233701, 0.163021, -0.258781, -0.019380, -0.023940, 0.160741, -0.185821, -0.224581, 0.176701, 0.028500, 0.119701, 0.128821, -0.288421, -0.226861, -0.017100, 0.233701, -0.001140, -0.005700, -0.256501, 0.156181, 0.060420, -0.115141, -0.001140, 0.001140, -0.046740, 0.149341, 
800
-0.049020, -0.003420, 0.137941, -0.242821, 0.103740, -0.144781, 0.267901, 0.099180, -0.021660, 0.256501, -0.181261, -0.026220, 0.028500, 0.060420, 0.067260, 0.012540, 0.074100, 0.381902, -0.074100, 0.074100, -0.160741, 0.110581, 0.078660, 0.231421, -0.074100, 0.078660, 0.163021, 0.085500, -0.165301, 0.222301, -0.010260, 
900
0.071820, 0.069540, 0.172141, 0.258781, -0.051300, -0.017100, -0.069540, -0.108301, 0.023940, -0.092340, 0.178981, 0.023940, -0.074100, -0.012540, -0.021660, 0.149341, 0.208621, 0.037620, 0.005700, -0.064980, 0.076380, 0.069540, 0.151621, -0.080940, -0.133381, -0.208621, -0.071820, -0.071820, -0.217741, 0.010260, -0.049020,
1000
0.176701, 0.044460, 0.108301, -0.033060, 0.188101, 0.176701, 0.092340, 0.033060, 0.183541, 0.103740, -0.035340, -0.518702, 0.181261, 0.078660, -0.042180, -0.190381, -0.060420, 0.156181, 0.026220, 0.201781, 0.103740, 0.183541, -0.042180, -0.112861, 0.074100, 0.144781, -0.144781, 0.053580, 0.133381, -0.039900, -0.087780, 
2000
0.096900, -0.085500, 0.076380, 0.074100, -0.235981, 0.263341, -0.147061, -0.003420, 0.272461, 0.142501, 0.064980, 0.395582, 0.131101, -0.169861, -0.115141, 0.140221, 0.144781, -0.151621, 0.106020, 0.055860, -0.012540, 0.094620, -0.046740, 0.345422, -0.119701, -0.249661, -0.178981, -0.071820, -0.053580, -0.213181, -0.012540, 
3000
2.135230, 2.506872, 0.352262, 5.774127, 2.367791, 2.256071, -1.567507, 0.338582, -3.368716, 0.541503, -4.807402, 1.118345, -2.420231, 0.701103, 1.781828, 4.009399, -0.386462, -2.693833, 1.214106, -2.390591, 0.767224, 5.028563, 3.229635, -3.685637, -0.678303, -0.035340, 1.784108, -1.882149, 0.370502, 0.222301, -0.530102, 
4000
0.060420, 0.361382, 0.281581, -0.315781, 0.648663, 0.156181, 0.206341, 0.580263, -0.530102, 0.290701, 0.361382, -0.468542, 0.005700, -0.137941, 0.044460, 0.060420, 0.090060, 0.199501, 0.007980, 0.530102, 0.012540, -0.019380, 0.074100, -0.010260, 0.112861, -0.204061, -0.288421, -0.673743, -0.017100, -0.411542, -0.074100, 
5000
0.199501, -0.208621, -0.149341, -0.274741, 0.204061, -0.217741, -0.372782, -0.035340, 0.336302, 0.320341, 0.245101, 0.397862, 0.356822, -0.546063, 0.318061, -0.160741, 0.106020, -0.245101, -0.069540, 0.609903, -0.140221, -0.030780, 0.648663, 0.131101, 0.005700, -0.210901, 0.174421, 0.078660, 0.377342, -0.418382, -0.147061, 
6000
0.386462, 1.043105, -3.008474, 2.486352, -1.879869, -1.287066, -0.315781, 2.185390, 1.325826, 0.703383, 1.549267, -5.824287, -0.354542, 2.351831, 2.864833, 0.794584, 0.783184, -3.692477, 2.101030, -0.035340, -0.767224, 5.030843, -2.764513, -0.888064, -1.891269, -1.640468, -0.028500, -1.626788, 2.896754, -2.971994, -0.997505, 
7000
0.518702, -0.085500, 0.249661, -0.256501, 0.539223, -0.329462, 0.539223, 1.323546, 0.096900, 0.660063, 0.117421, 0.069540, 0.730743, -0.785464, -0.087780, 0.438902, 0.267901, 0.402422, 0.432062, -0.290701, 0.039900, -0.163021, 0.117421, 0.375062, 1.061345, -0.046740, -0.112861, 0.557463, -0.477662, -0.028500, 0.527822, 
8000
0.445742, -0.142501, 0.958744, -0.226861, -0.550623, 0.204061, 0.131101, 0.356822, 0.352262, -0.286141, -0.181261, 0.087780, 0.502742, -0.156181, -0.001140, 0.037620, -0.201781, 0.413822, -0.185821, -0.074100, -0.286141, 0.071820, -0.281581, -0.026220, 0.445742, -0.258781, -0.222301, 0.046740, -0.375062, 0.010260, -0.163021, 
9000
1.086425, -1.328106, 1.724828, 1.111505, 2.422511, 0.516422, -2.869393, -5.293045, -1.236906, 1.900389, 0.306661, -1.111505, -0.153901, 2.185390, 0.571143, 1.049945, -1.939149, -0.388742, -0.778624, -0.956464, 0.302101, -1.104665, -0.422942, 3.003914, -0.748983, 1.761308, 1.428427, -0.942784, -0.432062, -0.833344, 1.145705, 
10000
0.562023, -0.270181, -0.106020, 0.306661, 0.128821, -0.379622, 0.149341, 0.124261, -0.689703, 0.329462, -0.416102, 0.313501, -0.338582, 1.027145, -0.046740, 0.194941, -0.117421, 0.149341, -0.577983, -1.517347, -0.128821, 0.687423, -0.523262, 0.019380, -0.014820, 0.379622, 0.147061, -0.600783, 0.438902, 0.831064, 0.605343, 
20000
0.318061, -0.372782, 1.280226, -0.092340, -0.571143, 0.801424, -0.940504, -0.493622, -0.418382, -0.174421, -0.550623, 0.258781, -0.502742, 0.181261, 0.222301, -0.229141, -0.334022, -0.443462, 0.112861, 0.245101, -0.737583, 0.783184, -0.518702, -0.324902, 0.614463, 0.527822, 0.484502, -0.069540, 0.375062, 0.475382, -0.201781, 
30000
0.288421, 0.970145, -0.888064, -1.255146, 0.990665, 0.160741, 0.165301, -0.131101, -0.090060, 0.605343, 1.303026, 0.331742, -0.404702, -1.412467, 0.454862, -0.728463, 0.263341, 0.049020, 0.457142, -0.174421, 0.505022, 0.906304, 0.014820, 0.853864, -1.448947, 0.197221, 0.074100, 2.655072, 0.356822, 1.109225, -0.429782, 
40000
-4.588521, -4.522401, -34.431581, 10.094747, -2.561592, -9.294463, -6.478650, -11.307713, 7.707576, -3.218235, -8.968422, 4.745842, -17.379381, 5.783247, 13.998125, 8.088338, 1.720268, 20.373035, 16.107135, -19.588711, -14.326447, -24.096292, 20.512116, 7.167213, 34.481741, 6.731731, 11.588154, -6.029488, -9.401624, -15.667093, 1.088705, 
50000
-1.264266, -0.039900, 0.482222, 0.949624, 1.200426, -0.514142, 0.235981, -1.038545, 0.229141, 0.343142, -0.926824, 1.505947, 1.056785, 1.316706, -0.413822, 2.073670, 1.020305, 1.093265, 0.819664, 0.669183, 1.679228, -0.831064, -0.192661, 0.463982, 1.900389, -0.593943, 0.470822, -0.862984, -1.200426, -0.188101, -2.030349, 
60000
-1.533307, 0.165301, -0.329462, 0.213181, 1.036265, -1.013465, 0.557463, -0.340862, 0.828784, -1.369146, 0.575703, 1.754468, 1.002065, -0.124261, 1.535587, -1.765868, 0.589383, 1.305306, 1.606267, 0.064980, -0.121981, -0.760384, 1.070465, -0.575703, 1.624508, -1.116065, -0.178981, -0.420662, 0.165301, -0.030780, -0.910864, 
70000
1.266546, -4.554321, -0.949624, 1.373706, 0.295261, -1.157105, -1.863909, 0.158461, -0.644103, 2.401991, -1.239186, -0.356822, 1.911789, -0.306661, -0.571143, -2.949194, 0.728463, 1.592587, -2.326751, -1.328106, 0.730743, 1.505947, -0.128821, 2.883073, 2.830633, -2.240110, -1.061345, -0.267901, 1.558387, 1.077305, -1.471747, 
80000
0.375062, -14.834889, 1.038545, -6.567571, -1.243746, 0.705663, 0.256501, -0.238261, 8.234258, 12.819360, 10.751390, 1.708868, -2.251511, 1.072745, 1.927749, 15.208811, -3.448516, -2.607192, 9.419864, 6.182249, 1.572067, 3.384676, -2.953754, 17.958504, -2.677872, -2.933234, 8.389299, -12.263037, 2.593512, -7.974337, 0.691983, 
90000
2.534232, 0.931384, -1.362306, -1.350906, -1.106945, 2.506872, 0.593943, -0.862984, 2.178550, -0.033060, -1.200426, -0.657783, 0.571143, 1.321266, 0.176701, 0.281581, -0.901744, -0.475382, -2.413391, 2.449871, -0.074100, -1.508227, -1.697468, 2.379191, -0.787744, 0.331742, 1.572067, 2.582112, -0.334022, 0.062700, 0.733023, 
100000
0.023940, 0.235981, 1.013465, -1.708868, -1.018025, 0.003420, -1.387386, 0.370502, -0.856144, -1.843389, -2.531952, 0.083220, -2.659632, 0.746703, -0.493622, 0.153901, 0.801424, 0.644103, -0.290701, -1.724828, 0.915424, 0.475382, 0.493622, -0.623583, -0.135661, 1.451227, -0.427502, -0.872104, 0.981545, 0.767224, 0.566583, 

### CODE ###
import numpy as np
import time

def beamforming_das(rx, distance, no_ele):
    theta_sweep = np.linspace(-1 * np.pi / 2, np.pi / 2,
                              78948)  # Deler -pi/2 til pi/2 op i 1000 segmenter og gemmer i et array
    results = []  # Laver tomt array til resultater
    for thetas in theta_sweep:  # For alle de værdier i theta sweep, kører vi
        w = np.exp(2j * np.pi * distance * np.arange(no_ele) * np.sin(
            thetas))  # Weight vektor tilsvarende "steering vektoren" køres for theta
        y = w.conj().T @ rx  # Vi kompleks konjugere for at modarbejde faseforskydningen og transponerer så matricen har den rigtige form
        results.append(
            np.abs(np.sum(y)))  # Vi finder modulus af de to beamformede datapunkter summeret og gemmer dem i arrayet
    return np.rad2deg(theta_sweep[np.argmax(
        results)])  # Vi kigger efter den theta hvor amplituden er størst og returnere den i grader

def snr_to_peak_amplitude(SNR):
    snr_lin = 10 ** (SNR / 10)
    a_noise_rms = 1 / np.sqrt(snr_lin)
    a_noise = a_noise_rms * np.sqrt(2)
    return a_noise

sample_space = np.concatenate([np.arange(1, 10) * 10 ** k for k in range(5)])
sample_space = np.append(sample_space, 100000)
sample_rate = 61.44e6
f = 2e4
d = 0.5  # half wavelength spacing
theta_deg = 0  # Angle of arrival
theta_rad = np.deg2rad(theta_deg)
elements = 2
k = np.arange(elements)

print('---20 dB SNR Test Start---')
print('SAMPLE SIZE, ELAPSED TIME (s), AOA')
for sample_size in sample_space:
    N = sample_size  # samples
    print(N)
    for i in range(31):
        t = np.arange(N) / sample_rate  # time vector
        tx = np.exp(2j * np.pi * f * t)
        s = np.exp(2j * np.pi * d * k * np.sin(theta_rad))
        s = s.reshape(-1, 1)  # make s a column vector
        tx = tx.reshape(1, -1)  # make tx a row vector
        X = s @ tx
        n = np.random.randn(elements, N) + 1j * np.random.randn(elements, N)  # Noise
        X_n = X + snr_to_peak_amplitude(20) * n
        start = time.perf_counter()
        results = beamforming_das(X_n, d, elements)
        stop = time.perf_counter()
        print(f'{results:.6f}', end=', ')
    print('')
