ANGLE, BEAMFORMING OUTPUT AOA, DELTA, COMPUTE TIME
-90, -90.000000, 0.000000, 0.6428
-89, -88.999075, 0.000925, 0.6122
-88, -88.000431, 0.000431, 0.6237
-87, -86.999506, 0.000494, 0.6237
-86, -86.000861, 0.000861, 0.6039
-85, -84.999937, 0.000063, 0.6363
-84, -83.999012, 0.000988, 0.6166
-83, -83.000367, 0.000367, 0.6051
-82, -81.999443, 0.000557, 0.6226
-81, -81.000798, 0.000798, 0.6083
-80, -79.999873, 0.000127, 0.6102
-79, -78.998949, 0.001051, 0.6229
-78, -78.000304, 0.000304, 0.6111
-77, -76.999379, 0.000621, 0.6173
-76, -76.000735, 0.000735, 0.6394
-75, -74.999810, 0.000190, 0.6235
-74, -73.998885, 0.001115, 0.6198
-73, -73.000241, 0.000241, 0.6333
-72, -71.999316, 0.000684, 0.6238
-71, -71.000671, 0.000671, 0.5728
-70, -69.999747, 0.000253, 0.6208
-69, -69.001102, 0.001102, 0.6102
-68, -68.000177, 0.000177, 0.6687
-67, -66.999253, 0.000747, 0.6167
-66, -66.000608, 0.000608, 0.6351
-65, -64.999683, 0.000317, 0.6358
-64, -64.001039, 0.001039, 0.6131
-63, -63.000114, 0.000114, 0.6176
-62, -61.999189, 0.000811, 0.6239
-61, -61.000545, 0.000545, 0.6129
-60, -59.999620, 0.000380, 0.6305
-59, -59.000975, 0.000975, 0.6164
-58, -58.000051, 0.000051, 0.6277
-57, -56.999126, 0.000874, 0.6151
-56, -56.000481, 0.000481, 0.6167
-55, -54.999557, 0.000443, 0.6103
-54, -54.000912, 0.000912, 0.6156
-53, -52.999987, 0.000013, 0.6030
-52, -51.999063, 0.000937, 0.6195
-51, -51.000418, 0.000418, 0.6136
-50, -49.999493, 0.000507, 0.6055
-49, -49.000849, 0.000849, 0.6211
-48, -47.999924, 0.000076, 0.6219
-47, -46.998999, 0.001001, 0.6236
-46, -46.000355, 0.000355, 0.6187
-45, -44.999430, 0.000570, 0.6286
-44, -44.000785, 0.000785, 0.6088
-43, -42.999861, 0.000139, 0.6120
-42, -41.998936, 0.001064, 0.6080
-41, -41.000291, 0.000291, 0.6159
-40, -39.999367, 0.000633, 0.6383
-39, -39.000722, 0.000722, 0.6228
-38, -37.999797, 0.000203, 0.6010
-37, -36.998873, 0.001127, 0.6158
-36, -36.000228, 0.000228, 0.6155
-35, -34.999303, 0.000697, 0.6083
-34, -34.000659, 0.000659, 0.6343
-33, -32.999734, 0.000266, 0.6106
-32, -32.001089, 0.001089, 0.5905
-31, -31.000165, 0.000165, 0.6110
-30, -29.999240, 0.000760, 0.6167
-29, -29.000595, 0.000595, 0.5862
-28, -27.999671, 0.000329, 0.5942
-27, -27.001026, 0.001026, 0.5878
-26, -26.000101, 0.000101, 0.5949
-25, -24.999177, 0.000823, 0.5845
-24, -24.000532, 0.000532, 0.6016
-23, -22.999607, 0.000393, 0.5898
-22, -22.000963, 0.000963, 0.6005
-21, -21.000038, 0.000038, 0.5964
-20, -19.999113, 0.000887, 0.5930
-19, -19.000469, 0.000469, 0.6150
-18, -17.999544, 0.000456, 0.6211
-17, -17.000899, 0.000899, 0.6092
-16, -15.999975, 0.000025, 0.6331
-15, -14.999050, 0.000950, 0.6124
-14, -14.000405, 0.000405, 0.6223
-13, -12.999481, 0.000519, 0.6203
-12, -12.000836, 0.000836, 0.6280
-11, -10.999911, 0.000089, 0.6070
-10, -9.998987, 0.001013, 0.6316
-9, -9.000342, 0.000342, 0.6069
-8, -7.999417, 0.000583, 0.5944
-7, -7.000773, 0.000773, 0.6198
-6, -5.999848, 0.000152, 0.6225
-5, -4.998923, 0.001077, 0.6044
-4, -4.000279, 0.000279, 0.6083
-3, -2.999354, 0.000646, 0.6036
-2, -2.000709, 0.000709, 0.6108
-1, -0.999785, 0.000215, 0.5974
0, -0.001140, 0.001140, 0.6277
1, 0.999785, 0.000215, 0.6020
2, 2.000709, 0.000709, 0.6107
3, 2.999354, 0.000646, 0.6443
4, 4.000279, 0.000279, 0.5960
5, 4.998923, 0.001077, 0.6280
6, 5.999848, 0.000152, 0.6217
7, 7.000773, 0.000773, 0.5918
8, 7.999417, 0.000583, 0.6175
9, 9.000342, 0.000342, 0.6128
10, 9.998987, 0.001013, 0.6000
11, 10.999911, 0.000089, 0.5928
12, 12.000836, 0.000836, 0.5960
13, 12.999481, 0.000519, 0.5904
14, 14.000405, 0.000405, 0.6193
15, 14.999050, 0.000950, 0.6054
16, 15.999975, 0.000025, 0.6176
17, 17.000899, 0.000899, 0.6070
18, 17.999544, 0.000456, 0.6406
19, 19.000469, 0.000469, 0.6117
20, 19.999113, 0.000887, 0.6070
21, 21.000038, 0.000038, 0.6011
22, 22.000963, 0.000963, 0.6165
23, 22.999607, 0.000393, 0.6272
24, 24.000532, 0.000532, 0.6550
25, 24.999177, 0.000823, 0.6183
26, 26.000101, 0.000101, 0.6285
27, 27.001026, 0.001026, 0.6162
28, 27.999671, 0.000329, 0.6331
29, 29.000595, 0.000595, 0.6238
30, 29.999240, 0.000760, 0.6467
31, 31.000165, 0.000165, 0.6040
32, 32.001089, 0.001089, 0.6522
33, 32.999734, 0.000266, 0.6641
34, 34.000659, 0.000659, 0.6397
35, 34.999303, 0.000697, 0.6240
36, 36.000228, 0.000228, 0.6534
37, 36.998873, 0.001127, 0.6354
38, 37.999797, 0.000203, 0.6177
39, 39.000722, 0.000722, 0.6435
40, 39.999367, 0.000633, 0.6221
41, 41.000291, 0.000291, 0.6481
42, 41.998936, 0.001064, 0.6499
43, 42.999861, 0.000139, 0.5977
44, 44.000785, 0.000785, 0.6172
45, 44.999430, 0.000570, 0.5846
46, 46.000355, 0.000355, 0.6039
47, 46.998999, 0.001001, 0.6026
48, 47.999924, 0.000076, 0.6147
49, 49.000849, 0.000849, 0.6037
50, 49.999493, 0.000507, 0.6230
51, 51.000418, 0.000418, 0.6286
52, 51.999063, 0.000937, 0.6004
53, 52.999987, 0.000013, 0.6220
54, 54.000912, 0.000912, 0.6076
55, 54.999557, 0.000443, 0.6085
56, 56.000481, 0.000481, 0.6097
57, 56.999126, 0.000874, 0.6155
58, 58.000051, 0.000051, 0.6085
59, 59.000975, 0.000975, 0.6089
60, 59.999620, 0.000380, 0.6437
61, 61.000545, 0.000545, 0.6068
62, 61.999189, 0.000811, 0.6288
63, 63.000114, 0.000114, 0.6069
64, 64.001039, 0.001039, 0.5968
65, 64.999683, 0.000317, 0.6105
66, 66.000608, 0.000608, 0.6017
67, 66.999253, 0.000747, 0.6324
68, 68.000177, 0.000177, 0.6463
69, 69.001102, 0.001102, 0.6427
70, 69.999747, 0.000253, 0.6129
71, 71.000671, 0.000671, 0.6289
72, 71.999316, 0.000684, 0.6363
73, 73.000241, 0.000241, 0.6094
74, 73.998885, 0.001115, 0.6162
75, 74.999810, 0.000190, 0.6449
76, 76.000735, 0.000735, 0.6214
77, 76.999379, 0.000621, 0.6651
78, 78.000304, 0.000304, 0.5970
79, 78.998949, 0.001051, 0.6086
80, 79.999873, 0.000127, 0.6209
81, 81.000798, 0.000798, 0.6290
82, 81.999443, 0.000557, 0.6204
83, 83.000367, 0.000367, 0.6098
84, 83.999012, 0.000988, 0.6294
85, 84.999937, 0.000063, 0.5875
86, 86.000861, 0.000861, 0.5916
87, 86.999506, 0.000494, 0.6399
88, 88.000431, 0.000431, 0.6138
89, 88.999075, 0.000925, 0.6500
90, -90.000000, 180.000000, 0.6189

Process finished with exit code 0

########## CODE #############

import time
import numpy as np

def beamforming_das(rx, distance, no_ele):
    theta_sweep = np.linspace(-1*np.pi/2, np.pi/2, 78948)
    results = []
    for thetas in theta_sweep:
       w = np.exp(2j * np.pi * distance * np.arange(no_ele) * np.sin(thetas))
       y = w.conj().T @ rx
       results.append(np.abs(np.sum(y)))
    return np.rad2deg(theta_sweep[np.argmax(results)])

sample_rate = 61.44e6
N = 1
t = np.arange(N)/sample_rate


### TX SIGNAL

angles = np.arange(-90, 91, 1)
print("ANGLE, BEAMFORMING OUTPUT AOA, DELTA, COMPUTE TIME")
for angle in angles:
    theta_deg = 0 # Angle of arrival
    theta_rad = np.deg2rad(angle)
    f = 2e4
    tx = np.exp(2j * np.pi * f * t)
    d = 0.5
    elements = 2
    k = np.arange(elements)

    s = np.exp(2j * np.pi * d * k * np.sin(theta_rad))
    s = s.reshape(-1,1)
    tx = tx.reshape(1,-1)

    ### RX SIGNAL
    X = s @ tx
    n = np.random.randn(elements, N) + 1j*np.random.randn(elements, N)
    X_n = X + 0.0 * n

    ### TEST CODE
    ## FUNCTIONALITY TEST
    start = time.perf_counter()
    bf_signal = beamforming_das(X_n, d, elements)
    stop = time.perf_counter()
    print(f"{angle}, {bf_signal:.6f}, {np.abs(angle-bf_signal):.6f}, {stop-start:.4f}")