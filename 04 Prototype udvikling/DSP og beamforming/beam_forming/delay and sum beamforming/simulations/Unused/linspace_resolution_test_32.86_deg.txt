Linspace resolution test @ 32.86 degrees

SUBDIVISIONS, ELAPSED TIME (s), AOA
9, 0.001616, 22.5
18, 0.002568, 37.05882352941176
36, 0.003976, 33.42857142857143
72, 0.007016, 31.690140845070434
144, 0.015506, 33.35664335664335
288, 0.029431, 32.92682926829268
576, 0.068260, 32.71304347826087
1152, 0.167002, 32.91920069504779
2304, 0.326291, 32.86582718193659
4608, 0.531245, 32.87822878228781
9216, 1.344187, 32.864894194248514
18432, 2.555424, 32.85822798545927
36864, 5.137985, 32.859778097279126
73728, 9.695220, 32.8605531216515
147456, 20.090428, 32.859719914550205

##########################################################################
TEST CODE
##########################################################################
import time
import numpy as np

sample_rate = 61.44e6
N = 10000
t = np.arange(N)/sample_rate # time vector

### TX SIGNAL
theta_deg = 32.86 # Angle of arrival
theta_rad = np.deg2rad(theta_deg)
f = 2e4
tx = np.exp(2j * np.pi * f * t)
d = 0.5
elements = 2
k = np.arange(elements)

s = np.exp(2j * np.pi * d * k * np.sin(theta_rad))
s = s.reshape(-1,1)
tx = tx.reshape(1,-1)

### RX SIGNAL
X = s @ tx
n = np.random.randn(elements, N) + 1j*np.random.randn(elements, N)
X_n = X + 0.0 * n

### TEST CODE
## FUNCTIONALITY TEST
for i in range(1,21):
    angle_subdiv = 9*2**(i-1)
    start = time.perf_counter()
    theta_sweep = np.linspace(-1 * np.pi / 2, np.pi / 2, angle_subdiv)
    results = []
    for thetas in theta_sweep:
        w = np.exp(2j * np.pi * d * k * np.sin(thetas))
        y = w.conj().T @ X_n
        results.append(np.abs(np.sum(y)))
    stop = time.perf_counter()
    print(f"{angle_subdiv}, {stop-start:.6f}, {np.rad2deg(theta_sweep[np.argmax(results)])}")