sample_size_accuracy_runtime_test_32.86_deg

---Clean Test Start---
SAMPLE SIZE, ELAPSED TIME (s), AOA
1, 0.007641, 32.8828829
2, 0.007285, 32.8828829
3, 0.007557, 32.8828829
4, 0.007950, 32.8828829
5, 0.007542, 32.8828829
6, 0.009082, 32.8828829
7, 0.007763, 32.8828829
8, 0.007668, 32.8828829
9, 0.007709, 32.8828829
10, 0.007674, 32.8828829
20, 0.007542, 32.8828829
30, 0.007613, 32.8828829
40, 0.007672, 32.8828829
50, 0.007417, 32.8828829
60, 0.007445, 32.8828829
70, 0.007223, 32.8828829
80, 0.007441, 32.8828829
90, 0.008117, 32.8828829
100, 0.007514, 32.8828829
200, 0.007470, 32.8828829
300, 0.008124, 32.8828829
400, 0.008005, 32.8828829
500, 0.008616, 32.8828829
600, 0.008951, 32.8828829
700, 0.008927, 32.8828829
800, 0.009062, 32.8828829
900, 0.009772, 32.8828829
1000, 0.014591, 32.8828829
2000, 0.013234, 32.8828829
3000, 0.132075, 32.8828829
4000, 0.134191, 32.8828829
5000, 0.110347, 32.8828829
6000, 0.107473, 32.8828829
7000, 0.128423, 32.8828829
8000, 0.110604, 32.8828829
9000, 0.105611, 32.8828829
10000, 0.110786, 32.8828829
20000, 0.139949, 32.8828829
30000, 0.154846, 32.8828829
40000, 0.149176, 32.8828829
50000, 0.175914, 32.8828829
60000, 0.183104, 32.8828829
70000, 0.589906, 32.8828829
80000, 0.643784, 32.8828829
90000, 0.739515, 32.8828829
100000, 0.759115, 32.8828829
200000, 1.436515, 32.8828829
300000, 1.988976, 32.8828829
400000, 2.702457, 32.8828829
500000, 3.027803, 32.8828829
600000, 3.580158, 32.8828829
700000, 4.048818, 32.8828829
800000, 4.713627, 32.8828829
900000, 5.325523, 32.8828829
1000000, 5.971686, 32.8828829

---Dirty Test Start---
SAMPLE SIZE, ELAPSED TIME (s), AOA
1, 0.006849, 36.8468468
2, 0.006812, 32.1621622
3, 0.007114, 31.6216216
4, 0.007067, 34.5045045
5, 0.007751, 34.5045045
6, 0.007120, 33.0630631
7, 0.006880, 37.0270270
8, 0.008180, 32.1621622
9, 0.006869, 31.9819820
10, 0.006923, 32.1621622
20, 0.006853, 33.6036036
30, 0.006916, 33.9639640
40, 0.006902, 32.7027027
50, 0.006905, 33.2432432
60, 0.006943, 32.8828829
70, 0.007095, 33.2432432
80, 0.006993, 32.7027027
90, 0.006983, 32.5225225
100, 0.007183, 32.8828829
200, 0.007650, 33.0630631
300, 0.008225, 32.7027027
400, 0.008032, 33.2432432
500, 0.008170, 32.8828829
600, 0.008597, 32.8828829
700, 0.008286, 32.8828829
800, 0.008628, 32.8828829
900, 0.009189, 32.7027027
1000, 0.008978, 32.7027027
2000, 0.013589, 33.0630631
3000, 0.144892, 28.7387387
4000, 0.140665, 33.2432432
5000, 0.137521, 33.0630631
6000, 0.139920, 34.5045045
7000, 0.134663, 32.8828829
8000, 0.135356, 32.8828829
9000, 0.144887, 33.7837838
10000, 0.149286, 33.6036036
20000, 0.159252, 32.8828829
30000, 0.164079, 31.9819820
40000, 0.161295, 44.0540541
50000, 0.193867, 31.9819820
60000, 0.172308, 32.8828829
70000, 0.523378, 32.1621622
80000, 0.571993, 22.9729730
90000, 0.664348, 32.1621622
100000, 0.709331, 34.1441441
200000, 1.328243, 37.3873874
300000, 1.848085, 31.8018018
400000, 2.407194, 30.5405405
500000, 3.002774, 31.2612613
600000, 3.484739, 30.5405405
700000, 4.212870, 26.0360360
800000, 4.797900, 31.4414414
900000, 5.451871, 39.9099099
1000000, 6.112678, 36.1261261

##########################################################################
TEST CODE
##########################################################################
import time
import numpy as np

def beamforming_das(rx, distance, no_ele):
    theta_sweep = np.linspace(-1*np.pi/2, np.pi/2, 1000)
    results = []
    for thetas in theta_sweep:
       w = np.exp(2j * np.pi * distance * np.arange(no_ele) * np.sin(thetas))
       y = w.conj().T @ rx
       results.append(np.abs(np.sum(y)))
    return np.rad2deg(theta_sweep[np.argmax(results)])

sample_space = np.concatenate([np.arange(1, 10) * 10**k for k in range(6)])
sample_space = np.append(sample_space, 1000000)
sample_rate = 61.44e6
f = 2e4
d = 0.5 # half wavelength spacing
theta_deg = 32.86 # Angle of arrival
theta_rad = np.deg2rad(theta_deg)
elements = 2
k = np.arange(elements)

print('---Clean Test Start---')
print('SAMPLE SIZE, ELAPSED TIME (s), AOA')
for sample_size in sample_space:
    N = sample_size # samples
    t = np.arange(N)/sample_rate # time vector
    tx = np.exp(2j * np.pi * f * t)
    s = np.exp(2j * np.pi * d * k * np.sin(theta_rad))
    s = s.reshape(-1,1) # make s a column vector
    tx = tx.reshape(1,-1) # make tx a row vector
    X = s @ tx
    n = np.random.randn(elements, N) + 1j*np.random.randn(elements, N)
    X_n = X + 0 * n

    start = time.perf_counter()
    results = beamforming_das(X_n, d, elements)
    stop = time.perf_counter()
    print(f'{N}, {stop - start:.6f}, {results:.7f}')
print()

print('---Dirty Test Start---')
print('SAMPLE SIZE, ELAPSED TIME (s), AOA')
for sample_size in sample_space:
    N = sample_size # samples
    t = np.arange(N)/sample_rate # time vector
    tx = np.exp(2j * np.pi * f * t)
    s = np.exp(2j * np.pi * d * k * np.sin(theta_rad))
    s = s.reshape(-1,1) # make s a column vector
    tx = tx.reshape(1,-1) # make tx a row vector
    X = s @ tx
    n = np.random.randn(elements, N) + 1j*np.random.randn(elements, N)
    X_n = X + 0.1 * n
    start = time.perf_counter()
    results = beamforming_das(X_n, d, elements)
    stop = time.perf_counter()
    print(f'{N}, {stop - start:.6f}, {results:.7f}')
